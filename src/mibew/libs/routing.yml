# Pages that are available for all users
button:
    path: /b
    defaults: { _controller: Mibew\Controller\ButtonController::indexAction }

license:
    path: /license
    defaults: { _controller: Mibew\Controller\LicenseController::indexAction }

widget_gateway:
    path: /widget
    defaults: { _controller: Mibew\Controller\WidgetController::indexAction }

# Operators' pages

## Canned messages
canned_message_add:
    path: /operator/canned-message/add
    defaults:
        _controller: Mibew\Controller\CannedMessageController::showEditFormAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck
    methods: [GET]

canned_message_add_save:
    path: /operator/canned-message/add
    defaults:
        _controller: Mibew\Controller\CannedMessageController::submitEditFormAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck
    methods: [POST]

canned_message_delete:
    path: /operator/canned-message/{message_id}/delete
    defaults:
        _controller: Mibew\Controller\CannedMessageController::deleteAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck
    requirements:
        message_id: \d{1,10}

canned_message_edit:
    path: /operator/canned-message/{message_id}/edit
    defaults:
        _controller: Mibew\Controller\CannedMessageController::showEditFormAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck
    requirements:
        message_id: \d{1,10}
    methods: [GET]

canned_message_edit_save:
    path: /operator/canned-message/{message_id}/edit
    defaults:
        _controller: Mibew\Controller\CannedMessageController::submitEditFormAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck
    requirements:
        message_id: \d{1,10}
    methods: [POST]

canned_messages:
    path: /operator/canned-message
    defaults:
        _controller: Mibew\Controller\CannedMessageController::indexAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck

## Groups
group_delete:
    path: /operator/group/{group_id}/delete
    defaults:
        _controller: Mibew\Controller\GroupController::deleteAction
        _access_check: Mibew\AccessControl\Check\PermissionsCheck
        _access_permissions: [CAN_ADMINISTRATE]
    requirements:
        group_id: \d{1,10}

group_add:
    path: /operator/group/add
    defaults:
        _controller: Mibew\Controller\GroupController::showEditFormAction
        _access_check: Mibew\AccessControl\Check\PermissionsCheck
        _access_permissions: [CAN_ADMINISTRATE]
    methods: [GET]

group_add_save:
    path: /operator/group/add
    defaults:
        _controller: Mibew\Controller\GroupController::submitEditFormAction
        _access_check: Mibew\AccessControl\Check\PermissionsCheck
        _access_permissions: [CAN_ADMINISTRATE]
    methods: [POST]

group_edit:
    path: /operator/group/{group_id}/edit
    defaults:
        _controller: Mibew\Controller\GroupController::showEditFormAction
        _access_check: Mibew\AccessControl\Check\PermissionsCheck
        _access_permissions: [CAN_ADMINISTRATE]
    requirements:
        group_id: \d{1,10}
    methods: [GET]

group_edit_save:
    path: /operator/group/{group_id}/edit
    defaults:
        _controller: Mibew\Controller\GroupController::submitEditFormAction
        _access_check: Mibew\AccessControl\Check\PermissionsCheck
        _access_permissions: [CAN_ADMINISTRATE]
    requirements:
        group_id: \d{1,10}
    methods: [POST]

group_members:
    path: /operator/group/{group_id}/members
    defaults:
        _controller: Mibew\Controller\GroupController::showMembersFormAction
        _access_check: Mibew\AccessControl\Check\PermissionsCheck
        _access_permissions: [CAN_ADMINISTRATE]
    requirements:
        group_id: \d{1,10}
    methods: [GET]

group_members_save:
    path: /operator/group/{group_id}/members
    defaults:
        _controller: Mibew\Controller\GroupController::submitMembersFormAction
        _access_check: Mibew\AccessControl\Check\PermissionsCheck
        _access_permissions: [CAN_ADMINISTRATE]
    requirements:
        group_id: \d{1,10}
    methods: [POST]

groups:
    path: /operator/group
    defaults:
        _controller: Mibew\Controller\GroupController::indexAction
        _access_check: Mibew\AccessControl\Check\PermissionsCheck
        _access_permissions: [CAN_ADMINISTRATE]

## History
history:
    path: /operator/history
    defaults:
        _controller: Mibew\Controller\HistoryController::indexAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck

history_thread:
    path: /operator/history/thread/{thread_id}
    defaults:
        _controller: Mibew\Controller\HistoryController::threadAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck
    requirements:
        thread_id: \d{1,9}

history_user:
    path: /operator/history/user/{user_id}
    defaults:
        _controller: Mibew\Controller\HistoryController::userAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck
    requirements:
        user_id: .{0,63}

history_user_track:
    path: /operator/history/user-track
    defaults:
        _controller: Mibew\Controller\HistoryController::userTrackAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck

## Invitations
invite:
    path: /operator/invite
    defaults:
        _controller: Mibew\Controller\InvitationController::inviteAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck

## Password recovery
password_recovery:
    path: /operator/password-recovery
    defaults:
        _controller: Mibew\Controller\PasswordRecoveryController::indexAction

password_recovery_reset:
    path: /operator/password-recovery/reset
    defaults:
        _controller: Mibew\Controller\PasswordRecoveryController::resetAction

## Statistics
statistics:
    path: /operator/statistics/{type}
    defaults:
        type: "by-date"
        _controller: Mibew\Controller\StatisticsController::indexAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck
    requirements:
        type: by-date|by-operator|by-page

## Updates
updates:
    path: /operator/updates
    defaults:
        _controller: Mibew\Controller\UpdatesController::indexAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck

## Users (visitors avaiting page)
users:
    path: /operator/users
    defaults:
        _controller: Mibew\Controller\UsersController::indexAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck

users_update:
    path: /operator/users/update
    defaults:
        _controller: Mibew\Controller\UsersController::updateAction
        _access_check: Mibew\AccessControl\Check\LoggedInCheck
